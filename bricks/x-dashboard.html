<template users>
<div class=two-columns>

  <section class=block>

    <h1><x-icon figure=address-book></x-icon>Overview</h1>
    <div class=row>
      <input type=search name=name placeholder="Look up a client">
      <button class=primary>Search</button>
    </div>

    <div class=row>
      <strong>Filter</strong>
      <div>
        <x-tag :active="true">st-patrick</x-tag>
        <x-tag dimmed>palm</x-tag>
        <x-tag dimmed>archive</x-tag>
      </div>
    </div>

    <nav>
      <a :for="user in this.users" href=/user>
        <h3><x-icon figure=user></x-icon>${ this.user.name }</h3>
        <p><x-icon figure=clock color=#F5BA01></x-icon>pending since Jan 7th 2019 â€“ 5 tests</p>
        <x-tag :if="this.user" :for="tag in this.user.tags">hey${ this.tag }</x-tag>
      </a>
    </nav>
    <footer class="row  toolbar">
      <a href=/user class="button"><x-icon figure=user-plus></x-icon>Add a user</a>
    </footer>
  </section>

  <aside class=block>
    <h1><x-icon figure=balance-scale></x-icon>Balance</h1>
    <p><strong>47</strong> TCIs remaining</p>
    <p class=row>
      <span>Reload balance with</span>
      <input name=quantity type=number on:input="this.addCredit" value=50>
      <span>TCIs</span>
    </p>
    <stripe-button quantity="${ this.quantity || 50 }" class="button primary"><x-icon figure=credit-card></x-icon> Purchase</stripe-button>
  </aside>

</div>
</template>

<script>
  this.setState({
    quantity: 0,
    users: []
  })

  this.connected = async () => {
    const response = await api('/clients')
    this.state.users = response.data
    this.render()
  }

  this.changed = () => {
    console.table('state in dashboard', this.state.users)
  }

  this.addCredit = (event) => {
    this.render({ quantity: event.currentTarget.value })
  }
</script>

<style>
  @import url('/assets/css/main.css');

  nav a {
    position: relative;
    display: block;
    padding: .3rem .5rem;
    text-decoration: none;
    color: inherit;
    border-bottom: 1px solid #eee;
    transition: all .2s;
  }
  nav a:last-of-type {
    border-bottom: none;
  }
  nav a:hover,
  nav a:focus {
    background-color: var(--light-color);
    color: white;
    padding-left: .8rem;
  }
  nav h3,
  nav p {
    padding: 0;
    margin: 0;
    font-size: inherit;
  }
  nav p {
    font-size: .7rem;
    opacity: .8;
  }
  nav x-icon {
    display: inline-block;
    width: 1rem;
  }
  nav x-tag {
    position: absolute;
    right: 1rem;
    top: .5rem;
  }

  aside input {
    width: 3rem;
    padding: .1rem;
    border: 0;
    border-bottom: 1px dashed #888;
    text-align: center;
  }

  stripe-button {
    display: block !important;
    margin-top: 2rem;
  }
</style>
