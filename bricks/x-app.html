<template>
  <header>
    <h1 id=logo><a href="/">
      <img src=https://assets.tci.anthropedia.org/images/anthropedia.svg alt="Anthropedia Foundation">
    </a></h1>
    <div>
      ${ this.user.name }
    </div>
  </header>

  <main>
    <x-dashboard :if="this.page === 'dashboard'" user="${ this.user }"></x-dashboard>
    <client-edit :if="this.page === 'client-edit'" id="${ this.clientId }"></client-edit>
    <error-404 :if="this.page === 'error'"></error-404>
  </main>

  <footer>
    ANTHROPEDIA™ FOUNDATION is a U.S. registered 501(c)(3) tax-deductible nonprofit charity<br>
    ©2019 ANTHROPEDIA™ FOUNDATION all rights reserved.
  </footer>
</template>

<script>
  this.setState({
    page: '',
    clients: [],
    clientId: null,
    user: {}
  })

  page('/', () => this.render({ page: 'dashboard' }))
  page('/client', () => this.render({ page: 'client-edit', clientId: '' }))
  page('/client/:id', (req) => this.render({ page: 'client-edit', clientId: req.params.id }))

  page('*', () => this.state.page = 'error')

  page({ hashbang: true })

  this.connected = async () => {
    const response = await api('/user')
    this.render({ user: response.data })
  }
</script>

<style>
  header {
    padding: .1rem 1rem;
    background-color: var(--white-background);
    box-shadow: .3rem 0 .5rem rgba(0, 0, 0, .4);
    position: sticky;
    top: 0;
    z-index: 3;
  }
  #logo {
    width: 5rem;
  }
  #logo a,
  #logo img {
    display: inline-block;
    width: 100%;
  }
  header div {
    text-align: right;
  }

  footer {
    color: white;
    padding: 1rem;
    font-size: .6rem;
  }

</style>
