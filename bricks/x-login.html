<template user>
  <main class=block>
    <form on:submit="this.login">
      <input type=email name=email required class=row placeholder="Signin with your email">
      <input type=password name=password required class=row placeholder="Password">
      <button class=primary>Login</login>
    </form>
  </main>
</template>

<script>
  this.setState({ user: {} })

  this.login = async (event) => {
    event.preventDefault()
    const data = {
      email: this.root.querySelector('[name=email]').value,
      password: this.root.querySelector('[name=password]').value
    }
    const response = await api('/token', { data })
    if (!response.ok) return alert("Check your email and password")
    await this.state.user.authenticate(response.data)
    page('/')
  }
</script>

<style>
  @import url('/assets/css/main.css');
  form {
    margin: 0 auto;
  }
  button {
    width: 100%;
  }
</style>
