<template>
  <div class=two-columns>
    <main>
      <form on:submit="this.submit" class=block>
        <h1><i class="fas fa-user-plus"></i> Create a New Provider</h1>
        <fieldset>
          <legend>General Information</legend>
          <input class=row name="name" value="" placeholder="Full name" required>
          <input class=row type="email" name="email" value="" placeholder="Email address" required>
        </fieldset>
        <button>Create</button>
      </form>
    </main>

    <aside class=block>
      <h1><i class="fas fa-users"></i> Existing Providers</h1>
      <ul>
        <li :for="provider in this.providers">
          ${ this.provider.name } (${ this.provider.email }) â€“ ${ this.provider.credit } credits
        </li>
      </ul>
    </aside>
  </div>
</template>

<script>
  this.setState({
    providers: [],
  })

  this.submit = async (event) => {
    event.preventDefault()
    const form = event.target
    const data = { name: form.name.value, email: form.email.value }
    const response = await api('/provider', { data })
    if(!response.ok) return notify(response.data)
    notify("Provider created!")
    page()
  }

  this.connected = async () => {
    const response = await api('/providers')
    const providers = response.data
    this.render({ providers })
  }
</script>

<style>
  @import url(/assets/css/main.css);
  form {
    max-width: inherit;
  }

  aside ul {
    padding: 0;
  }
  aside li {
    padding: 1rem;
    border-bottom: 1px solid #ddd;
    list-style: none;
  }
</style>
